{"version":3,"sources":["webpack:///webpack/bootstrap b90a47a890754c2d7381","webpack:///external \"mongoose\"","webpack:///./server/models/anime.js","webpack:///./server/models/episode.js","webpack:///./server/models/user.js","webpack:///external \"express\"","webpack:///external \"passport\"","webpack:///external \"mongoose-url-slugs\"","webpack:///external \"mongoose-voting\"","webpack:///./server/models/comment.js","webpack:///./server/models/news.js","webpack:///./server/models/genre.js","webpack:///external \"chalk\"","webpack:///external \"axios\"","webpack:///./app.js","webpack:///external \"morgan\"","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///external \"helmet\"","webpack:///external \"compression\"","webpack:///external \"express-session\"","webpack:///external \"errorhandler\"","webpack:///external \"express-validator\"","webpack:///external \"dotenv/config\"","webpack:///external \"nuxt\"","webpack:///./server/models/index.js","webpack:///external \"bcrypt\"","webpack:///external \"crypto\"","webpack:///./server/routes/api.js","webpack:///./server/controller/anime_controller.js","webpack:///external \"lodash/uniqBy\"","webpack:///./server/controller/news_controller.js","webpack:///./server/routes/bot.js","webpack:///./server/controller/bot_controller.js","webpack:///external \"fs\"","webpack:///external \"image-downloader\"","webpack:///external \"request\"","webpack:///external \"throttled-request\"","webpack:///external \"throttled-queue\"","webpack:///./server/routes/user.js","webpack:///./server/controller/user_controller.js","webpack:///external \"connect-mongo\"","webpack:///./server/library/passport.js","webpack:///external \"passport-local\"","webpack:///external \"passport-facebook\"","webpack:///external \"passport-twitter\"","webpack:///external \"passport-google-oauth\"","webpack:///./nuxt.config.js","webpack:///external \"path\""],"names":["Schema","AnimeSchema","canonicalTitle","type","String","titles","Types","Mixed","kitsuId","Number","synopsis","averageRating","status","ageRating","ageRatingGuide","ratingRank","popularityRank","startDate","Date","endDate","youtubeVideoId","posterImages","coverImages","metaCount","episodes","ObjectId","ref","genres","timestamps","toJSON","virtuals","virtual","localField","foreignField","justOne","plugin","model","EpisodeSchema","seasonNumber","episode","relativeNumber","airDate","kitsuReleaseDate","anime","index","userSchema","username","unique","email","required","password","passwordResetToken","passwordResetExpires","facebook","twitter","google","tokens","Array","meta","birthDay","givenName","familyName","gender","enum","picture","coverImage","posX","posY","uri","pre","save","next","user","isModified","genSalt","err","salt","hash","methods","comparePassword","candidatePassword","cb","compare","isMatch","get","size","md5","createHash","update","digest","sizes","micro","nano","tiny","small","medium","large","xlarge","huge","Object","keys","reduce","previous","current","today","birthDate","age","getFullYear","m","getMonth","getDate","CommentSchema","author","body","replies","animeId","episodeId","newsId","NewsSchema","featuredImage","shortContent","content","Boolean","view","GenreSchema","name","description","genreModel","MongoStore","require","passportLib","App","config","port","express","configureMiddleware","configureRoutes","server","listen","console","log","green","address","options","socketOptions","keepAlive","connect","process","env","DB_HOST","connection","on","error","red","exit","expressApp","use","json","urlencoded","extended","origin","credentials","filter","shouldCompress","set","secret","TOKEN_SECRET","store","mongooseConnection","resave","rolling","saveUninitialized","cookie","maxAge","initialize","session","nuxt","render","req","res","headers","app","dev","trigger","build","Promise","resolve","then","start","catch","Anime","Episode","Genre","News","User","router","Router","getLatest","getEpisodes","getFeatured","controller","episodeQuery","aggregate","$sort","$lookup","from","as","$unwind","$limit","exec","result","relatedAnime","slice","$match","slug","query","$addFields","episodeSize","$size","$project","relatedEpisodes","length","send","find","_id","sort","limit","search","id","skip","page","animes","$or","populate","news","createdAt","genre","animegenre","request","throttledRequest","throttledQueue","throttle","configure","requests","milliseconds","i","response","JSON","parse","data","forEach","attributes","synopsisTr","episodeCount","nsfw","savedAnime","info","k","number","airdate","bold","resp","attribute","savedGenre","genreList","push","foundGenres","$in","lean","distinct","media","post","register","login","logout","assert","len","isEmail","equals","sanitize","normalizeEmail","gmail_remove_dots","errors","validationErrors","criteria","findOne","existingUser","logIn","notEmpty","authenticate","rememberme","destroy","LocalStrategy","Strategy","FacebookStrategy","TwitterStrategy","GoogleStrategy","OAuth2Strategy","serializeUser","done","deserializeUser","findById","usernameField","msg","clientID","FACEBOOK_ID","clientSecret","FACEBOOK_SECRET","callbackURL","profileFields","passReqToCallback","accessToken","refreshToken","profile","flash","kind","_json","existingEmailUser","consumerKey","TWITTER_KEY","consumerSecret","TWITTER_SECRET","tokenSecret","displayName","profile_image_url_https","GOOGLE_ID","GOOGLE_SECRET","image","url","emails","value","exports","isAuthenticated","redirect","isAuthorized","provider","path","split","token","module","head","title","charset","hid","link","script","src","srcDir","css","plugins","ssr","modules","axios","extendRoutes","routes","component","__dirname","filenames","manifest","vendor","chunk","extractCSS","postcss","zindex","extend","isClient","rule","rules","r","test","toString","splice","indexOf","loader","exclude","include","stringify","prefixize","output","jsonpFunction","bundleRenderer","shouldPreload","file","includes","http2","gzip","treshold"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 13);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap b90a47a890754c2d7381","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 0\n// module chunks = 0","import mongoose from 'mongoose';\nimport slug from 'mongoose-url-slugs';\nimport voting from 'mongoose-voting';\nimport Episode from './episode';\nimport Genre from './genre';\nimport Comment from './comment';\n\nconst Schema = mongoose.Schema;\n\nconst AnimeSchema = new Schema({\n    canonicalTitle: {\n        type: String\n    },\n    titles: Schema.Types.Mixed,\n    kitsuId: {\n        type: Number\n    },\n    synopsis: {\n        type: String\n    },\n    averageRating: {\n        type: Number\n    },\n    status: {\n        type: String\n    },\n    ageRating: {\n        type: String\n    },\n    ageRatingGuide: {\n        type: String\n    },\n    ratingRank: {\n        type: Number\n    },\n    popularityRank: {\n        type: Number\n    },\n    startDate: {\n        type: Date\n    },\n    endDate: {\n        type: Date\n    },\n    youtubeVideoId: {\n        type: String\n    },\n    posterImages: {\n        type: Schema.Types.Mixed\n    },\n    coverImages: {\n        type: Schema.Types.Mixed\n    },\n    metaCount: {\n        type: Number\n    },\n    episodes: [{type: Schema.Types.ObjectId, ref: Episode}],\n    genres: [{type: Schema.Types.ObjectId, ref: Genre}]\n}, {timestamps: true, toJSON: {virtuals: true}});\n\nAnimeSchema.virtual('relatedEpisodes', {\n    ref: 'Episode',\n    localField: '_id',\n    foreignField: 'anime',\n    justOne: false\n});\n\nAnimeSchema.virtual('relatedGenres', {\n    ref: 'Genre',\n    localField: 'genres',\n    foreignField: '_id',\n    justOne: false\n});\n\nAnimeSchema.virtual('relatedComments', {\n    ref: Comment,\n    localField: '_id',\n    foreignField: 'animeId',\n    justOne: false\n});\n\nAnimeSchema.plugin(slug('canonicalTitle'));\nAnimeSchema.plugin(voting, {ref: 'User'});\n\nexport default mongoose.model('Anime', AnimeSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/anime.js","import mongoose from 'mongoose';\nimport voting from 'mongoose-voting';\nimport Anime from './anime';\nimport Comment from './comment';\n\nconst Schema = mongoose.Schema;\n\nconst EpisodeSchema = new Schema({\n    canonicalTitle: {\n        type: String,\n    },\n    synopsis: {\n        type: String,\n    },\n    seasonNumber: {\n        type: Number,\n    },\n    episode: {\n        type: Number,\n    },\n    relativeNumber: {\n        type: Number,\n    },\n    airDate: {\n        type: Date,\n    },\n    kitsuReleaseDate: {\n        type: Date,\n    },\n    anime: {\n        type: Schema.Types.ObjectId,\n        ref: Anime,\n    },\n}, {timestamps: true, toJSON: {virtuals: true}});\n\nEpisodeSchema.virtual('relatedAnime', {\n    ref: 'Anime',\n    localField: 'anime',\n    foreignField: '_id',\n    justOne: true,\n});\n\nEpisodeSchema.virtual('relatedComments', {\n    ref: Comment,\n    localField: '_id',\n    foreignField: 'episodeId',\n    justOne: false\n});\n\nEpisodeSchema.index({kitsuReleaseDate: -1});\nEpisodeSchema.plugin(voting, {ref: 'User'});\n\nexport default mongoose.model('Episode', EpisodeSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/episode.js","import mongoose from 'mongoose';\nimport bcrypt from 'bcrypt';\nimport crypto from 'crypto';\n\nconst Schema = mongoose.Schema;\nconst userSchema = new Schema({\n    username: {\n        type: String,\n        unique: true,\n    },\n    email: {\n        type: String,\n        index: true,\n        unique: true,\n        required: true,\n    },\n    password: String,\n    passwordResetToken: String,\n    passwordResetExpires: Date,\n\n    facebook: String,\n    twitter: String,\n    google: String,\n    tokens: Array,\n\n    meta: {\n        birthDay: Date,\n        givenName: String,\n        familyName: String,\n        gender: {\n            type: String,\n            enum: ['male', 'female', 'unspecified'],\n        },\n        picture: String,\n        coverImage: {\n            posX: Number,\n            posY: Number,\n            uri: String\n        }\n    },\n}, {timestamps: true, toJSON: {virtuals: true}});\n\n/**\n * Password hash middleware.\n */\nuserSchema.pre('save', function save (next) {\n    const user = this;\n    if (!user.isModified('password')) { return next(); }\n    bcrypt.genSalt(10, (err, salt) => {\n        if (err) { return next(err); }\n        bcrypt.hash(user.password, salt, (err, hash) => {\n            if (err) { return next(err); }\n            user.password = hash;\n            next();\n        });\n    });\n});\n\n\n/**\n * Helper method for validating user's password.\n */\nuserSchema.methods.comparePassword = function comparePassword(candidatePassword, cb) {\n    bcrypt.compare(candidatePassword, this.password, (err, isMatch) => {\n        cb(err, isMatch);\n    });\n};\n\n/**\n * Helper method for getting user's gravatar.\n */\nuserSchema.virtual('gravatar').get(function () {\n    if (!this.email) {\n        return `https://gravatar.com/avatar/?s=${size}&d=retro`;\n    }\n    const md5 = crypto.createHash('md5').update(this.email).digest('hex');\n    const sizes = {\n        micro: 16,\n        nano: 24,\n        tiny: 32,\n        small: 48,\n        medium: 64,\n        large: 96,\n        xlarge: 128,\n        huge: 256,\n    };\n\n    return Object.keys(sizes).reduce(function (previous, current) {\n        previous[current] = `https://gravatar.com/avatar/${md5}?s=${sizes[current]}&d=retro`;\n        ;\n        return previous;\n    }, {});\n});\n\nuserSchema.virtual('fullName').get(function () {\n    if (!this.meta.givenName && !this.meta.familyName) {\n        return false;\n    }\n    return this.meta.givenName + ' ' + this.meta.familyName;\n});\n\nuserSchema.virtual('gender').get(function () {\n    let gender = 'Belirtilmemiş';\n    switch (this.meta.gender) {\n        case 'male':\n            gender = 'Erkek';\n            break;\n        case 'female':\n            gender = 'Kadın';\n            break;\n    }\n    return gender;\n});\n\nuserSchema.virtual('age').get(function () {\n    if (!this.meta.birthDay) {\n        return 'Belirtilmemiş.';\n    }\n\n    const today = new Date();\n    const birthDate = new Date(this.meta.birthDay);\n    let age = today.getFullYear() - birthDate.getFullYear();\n    const m = today.getMonth() - birthDate.getMonth();\n    if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {\n        age--;\n    }\n    return age;\n});\n\nexport default mongoose.model('User', userSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/user.js","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","module.exports = require(\"passport\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"mongoose-url-slugs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-url-slugs\"\n// module id = 6\n// module chunks = 0","module.exports = require(\"mongoose-voting\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-voting\"\n// module id = 7\n// module chunks = 0","import mongoose from 'mongoose';\nimport Anime from './anime';\nimport News from './news';\nimport Episode from './episode';\nimport User from './user';\n\nconst Schema = mongoose.Schema;\n\nconst CommentSchema = new Schema({\n    author: {type: Schema.Types.ObjectId, ref: User},\n    body: {\n        type: String\n    },\n    replies: [{\n        author: {type: Schema.Types.ObjectId, ref: User},\n        body: {type: String}\n    }],\n    animeId: {type: Schema.Types.ObjectId, ref: Anime},\n    episodeId: {type: Schema.Types.ObjectId, ref: Episode},\n    newsId: {type: Schema.Types.ObjectId, ref: News},\n}, {timestamps: true, toJSON: {virtuals: true}});\n\nCommentSchema.virtual('relatedAuthor', {\n    ref: 'User',\n    localField: 'author',\n    foreignField: '_id',\n    justOne: true\n});\n\nCommentSchema.index({newsId: 1, episodeId: 1, animeId: 1});\n\nexport default mongoose.model('Comment', CommentSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/comment.js","import mongoose from 'mongoose';\nimport slug from 'mongoose-url-slugs';\nimport voting from 'mongoose-voting';\nimport User from './user';\nimport Comment from './comment';\n\nconst Schema = mongoose.Schema;\n\nconst NewsSchema = new Schema({\n    canonicalTitle: {\n        type: String\n    },\n    featuredImage: {\n        type: String\n    },\n    shortContent: {\n        type: String\n    },\n    content: {\n        type: String\n    },\n    status: {\n        type: Boolean\n    },\n    view: {\n        type: Number\n    },\n    author: {type: Schema.Types.ObjectId, ref: User},\n}, {timestamps: true, toJSON: {virtuals: true}});\n\nNewsSchema.virtual('relatedAuthor', {\n    ref: 'User',\n    localField: 'author',\n    foreignField: '_id',\n    justOne: true\n});\n\nNewsSchema.virtual('relatedComments', {\n    ref: Comment,\n    localField: '_id',\n    foreignField: 'newsId',\n    justOne: false\n});\n\nNewsSchema.plugin(slug('canonicalTitle'));\nNewsSchema.plugin(voting, {ref: 'User'});\n\nexport default mongoose.model('News', NewsSchema);\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/news.js","import mongoose from 'mongoose';\nimport slug from 'mongoose-url-slugs';\nimport Anime from './anime';\n\nconst Schema = mongoose.Schema;\n\nconst GenreSchema = new Schema({\n    name: {\n        type: String\n    },\n    description: {\n        type: String\n    },\n    anime: [{type: Schema.Types.ObjectId, ref: Anime}]\n});\nGenreSchema.plugin(slug('name'));\nconst genreModel = mongoose.model('Genre', GenreSchema);\nexport default genreModel;\n\n\n\n// WEBPACK FOOTER //\n// ./server/models/genre.js","module.exports = require(\"chalk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chalk\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"axios\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"axios\"\n// module id = 12\n// module chunks = 0","/**\n * Core Elements\n */\nimport express from 'express';\nimport logger from 'morgan';\nimport bodyParser from 'body-parser';\nimport cors from 'cors';\nimport helmet from 'helmet';\nimport passport from 'passport';\nimport compression from 'compression';\nimport session from 'express-session';\nimport mongoose from 'mongoose';\nimport chalk from 'chalk';\nimport errorHandler from 'errorhandler';\nimport expressValidator from 'express-validator';\nimport {} from 'dotenv/config';\nimport {Nuxt, Builder} from 'nuxt';\nimport {Anime, Episode, Genre, User} from './server/models'\n\n/**\n * Routes\n */\nimport apiRoutes from './server/routes/api';\nimport botRoutes from './server/routes/bot';\nimport userRoutes from './server/routes/user';\n\nconst MongoStore = require('connect-mongo')(session);\nconst passportLib = require('./server/library/passport');\n\nclass App {\n    constructor(config) {\n        this.port = config.port;\n        this.express = express();\n    }\n\n    async initialize() {\n        await this.configureMiddleware();\n        await this.configureRoutes();\n    }\n\n    start() {\n        const server = this.express.listen(this.port, '0.0.0.0', () => {\n            console.log('%s App is running at http://localhost:%d in %s mode', chalk.green('✓'), server.address().port, process.env.NODE_ENV);\n            console.log('  Press CTRL-C to stop\\n');\n        });\n    }\n\n    configureMiddleware() {\n        const options = {server: {socketOptions: {keepAlive: 1}}};\n        mongoose.connect(process.env.DB_HOST, options);\n        mongoose.connection.on('error', (err) => {\n            console.error(err);\n            console.log('%s MongoDB connection error. Please make sure MongoDB is running.', chalk.red('✗'));\n            process.exit();\n        });\n\n        const expressApp = this.express;\n        expressApp.use(logger('dev'));\n        expressApp.use(bodyParser.json());\n        expressApp.use(bodyParser.urlencoded({extended: true}));\n        expressApp.use(expressValidator());\n        expressApp.use(cors({\n            origin:['http://localhost:3000'],\n            methods:['GET','POST'],\n            credentials: true\n        }));\n        expressApp.use(helmet());\n        expressApp.use(compression({filter: this.shouldCompress}));\n        expressApp.set('trust proxy', 1);\n        expressApp.use(session({\n            name: 'anizm.tv',\n            secret: process.env.TOKEN_SECRET,\n            store:  new MongoStore({ mongooseConnection: mongoose.connection }),\n            resave: true,\n            rolling: true,\n            saveUninitialized: true,\n            cookie: {maxAge: 86400000 }\n        }));\n        expressApp.use(passport.initialize());\n        expressApp.use(passport.session());\n        expressApp.use(errorHandler());\n    }\n\n    configureRoutes() {\n        const expressApp = this.express;\n        expressApp.use('/api', apiRoutes);\n        expressApp.use('/fetch', botRoutes);\n        expressApp.use('/user', userRoutes);\n        expressApp.use(nuxt.render);\n    }\n\n    static shouldCompress(req, res) {\n        if (req.headers['x-no-compression']) {\n            return false;\n        }\n        return compression.filter(req, res);\n    }\n}\n\nconst app = new App({port: 3000});\nconst config = require('./nuxt.config.js');\nconfig.dev = !(process.env.NODE_ENV === 'production');\n\nconst nuxt = new Nuxt(config);\nconst trigger = config.dev ? new Builder(nuxt).build() : Promise.resolve();\ntrigger.then(() => {\n    app.initialize().then(() => {\n        app.start();\n    });\n});\ntrigger.catch((error) => {\n    console.log(error);\n    process.exit(1);\n});\n\n\n// WEBPACK FOOTER //\n// ./app.js","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"compression\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"compression\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"errorhandler\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"errorhandler\"\n// module id = 20\n// module chunks = 0","module.exports = require(\"express-validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-validator\"\n// module id = 21\n// module chunks = 0","module.exports = require(\"dotenv/config\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv/config\"\n// module id = 22\n// module chunks = 0","module.exports = require(\"nuxt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"nuxt\"\n// module id = 23\n// module chunks = 0","import Anime from './anime'\nimport Episode from './episode'\nimport Genre from './genre'\nimport News from './news'\nimport User from './user'\n\nexport {Anime, Episode, Genre, News, User}\n\n\n// WEBPACK FOOTER //\n// ./server/models/index.js","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 25\n// module chunks = 0","module.exports = require(\"crypto\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"crypto\"\n// module id = 26\n// module chunks = 0","import express from 'express';\nimport animeController from '../controller/anime_controller';\nimport newsController from '../controller/news_controller';\n\nconst router = express.Router();\n\nrouter.get('/anime/getlatest', animeController.getLatest);\nrouter.get('/anime/getEpisodes', animeController.getEpisodes);\nrouter.get('/anime/getFeatured', animeController.getFeatured);\nrouter.get('/anime/get', animeController.get);\n\nrouter.get('/news/get', newsController.get);\n\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/api.js","import Episode from '../models/episode';\nimport Anime from '../models/anime';\nimport uniqBy from 'lodash/uniqBy';\n\nconst controller = {};\ncontroller.getLatest = function (req, res) {\n    const episodeQuery = Episode.aggregate([\n        {$sort: {kitsuReleaseDate: -1}},\n        {\n            $lookup: {\n                from: 'animes',\n                localField: 'anime',\n                foreignField: '_id',\n                as: 'relatedAnime',\n            }\n        },\n        {$unwind: '$relatedAnime'},\n        {$limit: 300},\n    ]).exec();\n    episodeQuery.then((result) => {\n        let episodes = uniqBy(result, 'anime');\n        episodes = episodes.filter((episode) => {\n            return episode.relatedAnime.averageRating > 0\n        });\n        episodes = episodes.slice(0, 12);\n        res.json(episodes);\n    });\n};\n\ncontroller.get = async (req, res) => {\n    const anime = await Anime.aggregate([\n        {$match: {slug: req.query.slug}},\n        {\n            $lookup: {\n                from: 'episodes',\n                localField: '_id',\n                foreignField: 'anime',\n                as: 'relatedEpisodes',\n            },\n        },\n        {\n            $lookup: {\n                from: 'genres',\n                localField: 'genres',\n                foreignField: '_id',\n                as: 'relatedGenres',\n            },\n        },\n        {\n            $addFields: {\n                episodeSize: {$size: '$relatedEpisodes'},\n            },\n        },\n        {$project: {relatedEpisodes: 0}},\n    ]).exec();\n\n    if (!anime.length) {\n        res.status(500).send({error: 'Something failed!'});\n    }\n\n    const episodes = await Episode.find({anime: anime[0]._id}).sort({episode: 1}).limit(24).exec();\n\n    res.json({\n        anime: anime[0],\n        episodes: episodes,\n    });\n};\n\ncontroller.getEpisodes = async (req, res, next) => {\n    if (req.query.search) {\n        const episodes = await Episode.find({\n            anime: req.query.id,\n            episode: req.query.search,\n        }).sort({episode: 1}).exec();\n        return res.json(episodes);\n    }\n    const episodes = await Episode.find({anime: req.query.id}).sort({episode: 1}).skip((req.query.page - 1) * 24).limit(24).exec();\n    res.json(episodes);\n};\n\ncontroller.getFeatured = async (req, res, next) => {\n    const animes = await Anime.find({$or: [{'kitsuId': 11}, {'kitsuId': 12}]}).populate('relatedGenres').exec();\n    res.json(animes);\n};\n\nexport default controller;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controller/anime_controller.js","module.exports = require(\"lodash/uniqBy\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash/uniqBy\"\n// module id = 29\n// module chunks = 0","import Episode from '../models/episode';\nimport Anime from '../models/anime';\nimport News from '../models/news';\n\nconst controller = {};\ncontroller.get = async function (req, res) {\n    let news;\n    if(req.query.slug){\n        news = await News.find({slug: req.query.slug}).exec();\n        return res.json(news);\n    }\n    news = await News.find({}).sort({createdAt: -1}).skip((req.query.page - 1) * 24).limit(24).exec();\n    res.json(news);\n};\n\ncontroller.update = function (req, res) {\n\n};\n\nexport default controller;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controller/news_controller.js","import express from 'express';\nimport botController from '../controller/bot_controller';\n\nconst router = express.Router();\n\nrouter.get('/anime', botController.anime);\nrouter.get('/episode', botController.episode);\nrouter.get('/genre', botController.genre);\nrouter.get('/animegenre', botController.animegenre);\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/bot.js","import fs from 'fs';\nimport download from 'image-downloader';\nimport axios from 'axios';\nimport chalk from 'chalk';\n\nimport Anime from '../models/anime';\nimport Episode from '../models/episode';\nimport Genre from '../models/genre';\n\nconst request = require('request');\nconst throttledRequest = require('throttled-request')(request);\nconst throttledQueue = require('throttled-queue');\nconst throttle = throttledQueue(15, 700);\n// This will throttle the requests so no more than 5 are made every second\nthrottledRequest.configure({\n    requests: 5,\n    milliseconds: 1500,\n});\n\nconst controller = {};\ncontroller.anime = (req, res) => {\n    for (let i = 0; i < 630; i += 1) {\n        throttledRequest(`https://kitsu.io/api/edge/anime?page[limit]=20&page[offset]=${i * 20}`, (error, response, body) => {\n            if (error) {\n                console.log(error);\n                return false;\n            }\n            JSON.parse(body).data.forEach((anime) => {\n                const attributes = anime.attributes;\n                const result = {};\n                const model = new Anime({\n                    canonicalTitle: attributes.canonicalTitle,\n                    titles: attributes.titles,\n                    kitsuId: anime.id,\n                    synopsis: attributes.synopsis,\n                    synopsisTr: attributes.synopsis,\n                    averageRating: attributes.averageRating,\n                    startDate: attributes.startDate ? new Date(attributes.startDate) : null,\n                    endDate: attributes.endDate ? new Date(attributes.endDate) : null,\n                    ratingRank: attributes.ratingRank,\n                    popularityRank: attributes.popularityRank,\n                    ageRating: attributes.ageRating,\n                    ageRatingGuide: attributes.ageRatingGuide,\n                    status: attributes.status,\n                    episodeCount: attributes.episodeCount,\n                    nsfw: attributes.nsfw,\n                    youtubeVideoId: attributes.youtubeVideoId || null,\n                    posterImages: {},\n                    coverImages: {}\n                });\n                model.save().then((savedAnime) => {\n                    console.info(`ANIME : ${savedAnime.canonicalTitle} has successfully saved`);\n                });\n            });\n        });\n    }\n    res.send();\n};\ncontroller.episode = (req, res) => {\n    Anime.find().then((animes) => {\n        animes.forEach((anime) => {\n            for (let k = 0; k < anime.metaCount; k++) {\n                throttle(function () {\n                    let request = axios.get(`https://kitsu.io/api/edge/anime/${anime.kitsuId}/episodes?page[limit]=20&page[offset]=${k * 20}`);\n                    request.then((episodes) => {\n                        const data = episodes.data.data;\n                        if (data.length <= 0) {\n                            return false;\n                        }\n                        data.forEach((episode) => {\n                            const attributes = episode.attributes;\n                            const model = new Episode({\n                                canonicalTitle: attributes.canonicalTitle,\n                                seasonNumber: attributes.seasonNumber,\n                                episode: attributes.number,\n                                relativeNumber: attributes.relativeNumber,\n                                synopsis: attributes.synopsis || null,\n                                airDate: new Date(attributes.airdate),\n                                kitsuReleaseDate: new Date(attributes.createdAt),\n                                anime: anime._id,\n                            });\n                            model.save().then(() => {\n                                console.info(`EPISODE : ${chalk.bold.red(anime.canonicalTitle)} episode added`);\n                            });\n                        });\n                    });\n                    request.catch((error) => {\n                        console.log(error);\n                        process.exit();\n                    })\n                });\n            }\n        });\n    });\n    res.send('bö');\n};\ncontroller.genre = (req, res) => {\n    request('https://kitsu.io/api/edge/genres?page%5Blimit%5D=900&page%5Boffset%5D=0', (err, response, body) => {\n        const resp = JSON.parse(body).data;\n        resp.forEach((genre) => {\n            const attribute = genre.attributes;\n            const result = {};\n\n            const model = new Genre({\n                name: attribute.name,\n                slug: attribute.slug,\n                description: attribute.description,\n            });\n\n            model.save(result).then((savedGenre) => {\n                console.info(`GENRE: ${savedGenre.name} added to DB`);\n            });\n        });\n    });\n    res.send();\n};\ncontroller.animegenre = (req, res) => {\n    Anime.find().then((animes) => {\n        animes.forEach((anime) => {\n            throttle(function () {\n                let request = axios.get(`https://kitsu.io/api/edge/anime/${anime.kitsuId}/genres`);\n                request.then((genres) => {\n                    const data = genres.data.data;\n                    if (data.length <= 0) {\n                        return false;\n                    }\n                    let genreList = [];\n                    data.forEach((genre) => {\n                        genreList.push(genre.attributes.slug);\n                    });\n                    const foundGenres = Genre.find({slug: {$in: genreList}}).lean().distinct('_id').exec();\n                    foundGenres.then(result => {\n                        anime.genres = result;\n                        anime.save();\n                        console.log('GENRE : ' + anime.canonicalTitle + ' added');\n                    });\n                });\n                request.catch((error) => {\n                    console.log(error);\n                })\n            });\n        });\n    });\n    res.send('asd');\n};\ncontroller.media = (req, res) => {\n    Anime.find().then((animes) => {\n        animes.forEach((anime) => {\n            throttle(function () {\n                let request = axios.get(`https://kitsu.io/api/edge/anime/${anime.kitsuId}/genres`);\n                request.then((genres) => {\n                    const data = genres.data.data;\n                    if (data.length <= 0) {\n                        return false;\n                    }\n                    let genreList = [];\n                    data.forEach((genre) => {\n                        genreList.push(genre.attributes.slug);\n                    });\n                    const foundGenres = Genre.find({slug: {$in: genreList}}).lean().distinct('_id').exec();\n                    foundGenres.then(result => {\n                        anime.genres = result;\n                        anime.save();\n                        console.log('GENRE : ' + anime.canonicalTitle + ' added');\n                    });\n                });\n                request.catch((error) => {\n                    console.log(error);\n                })\n            });\n        });\n    });\n    res.send('asd');\n};\nexport default controller;\n\n\n/*/\n\nconst id = savedAnime.id;\n                    const posterDir = `${__dirname}/../../public/media/poster_images/${id}/`;\n                    const coverDir = `${__dirname}/../../public/media/cover_images/${id}/`;\n\n                    if (!fs.existsSync(posterDir)) {\n                        fs.mkdirSync(posterDir);\n                    }\n                    if (!fs.existsSync(coverDir)) {\n                        fs.mkdirSync(coverDir);\n                    }\n\n\n                    // download posters\n                    for (let key in attributes.posterImage) {\n                        download.image({\n                            url: attributes.posterImage[key],\n                            dest: `${posterDir + key}.jpg`,\n                        }).then((poster) => {\n                            const size = poster.filename.split('/').pop().split('.')[0];\n                            savedAnime.posterImages[size] = '/media/poster_images/' + savedAnime.id + '/' + size + '.jpg';\n                            savedAnime.save();\n                        }).catch((error) => {\n                            console.log('unable to get an image');\n                            console.log(error.message);\n                        });\n                    }\n                    // download covers\n                    for (var key in attributes.coverImage) {\n                        download.image({\n                            url: attributes.coverImage[key],\n                            dest: `${coverDir + key}.jpg`,\n                        }).then((cover) => {\n                            const size = cover.filename.split('/').pop().split('.')[0];\n                            savedAnime.coverImages[size] = '/media/cover_images/' + savedAnime.id + '/' + size + '.jpg';\n                            savedAnime.save();\n                        }).catch((error) => {\n                            console.log('unable to get an image');\n                            console.log(error.message);\n                        });\n                    }\n                    for (let k = 0; k < 1; k++) {\n                        throttledRequest(`https://kitsu.io/api/edge/anime/${savedAnime.kitsuId}/episodes?page[limit]=20&page[offset]=${k * 20}`, (error, response, body) => {\n                            JSON.parse(body).data.forEach((episode) => {\n                                const attributes = episode.attributes;\n                                const result = {};\n                                Object.assign(result, {\n                                    canonicalTitle: attributes.canonicalTitle,\n                                    seasonNumber: attributes.seasonNumber,\n                                    episode: attributes.episode,\n                                    relativeNumber: attributes.relativeNumber,\n                                    synopsis: attributes.synopsis || null,\n                                    airdate: new Date(attributes.airdate),\n                                    animeId: savedAnime.id,\n                                });\n                                Episode.save(result).then(() => {\n                                    console.info(`EPISODE : ${savedAnime.canonicalTitle} episode added`);\n                                });\n                            });\n                        });\n                    }\n */\n\n\n// WEBPACK FOOTER //\n// ./server/controller/bot_controller.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 33\n// module chunks = 0","module.exports = require(\"image-downloader\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"image-downloader\"\n// module id = 34\n// module chunks = 0","module.exports = require(\"request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"request\"\n// module id = 35\n// module chunks = 0","module.exports = require(\"throttled-request\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"throttled-request\"\n// module id = 36\n// module chunks = 0","module.exports = require(\"throttled-queue\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"throttled-queue\"\n// module id = 37\n// module chunks = 0","import express from 'express';\nimport passport from 'passport';\nimport userController from '../controller/user_controller';\n\nconst router = express.Router();\n\nrouter.post('/register', userController.register);\nrouter.post('/login', userController.login);\nrouter.get('/logout', userController.logout);\nexport default router;\n\n\n\n// WEBPACK FOOTER //\n// ./server/routes/user.js","import passport from 'passport'\nimport User from '../models/user'\n\nconst controller = {};\ncontroller.register =(req, res, next) => {\n    req.assert('username', 'Geçersiz kullanıcı adı!').len(3);\n    req.assert('email', 'Geçersiz bir email adresi').isEmail();\n    req.assert('password', 'Şifreniz en az 4 karakter uzunluğunda olmalı. ').len(4);\n    req.assert('passwordConfirm', 'Şifreler uyuşmuyor').equals(req.body.password);\n    req.sanitize('email').normalizeEmail({ gmail_remove_dots: false });\n\n    const errors = req.validationErrors();\n\n    if (errors) {\n        return res.json({'error' : true,'errors': errors});\n    }\n    const user = new User({\n        username: req.body.username,\n        email: req.body.email,\n        password: req.body.password\n    });\n\n    const criteria = {$or: [{username: req.body.username}, {email: req.body.email}]};\n    return User.findOne(criteria, function(err, existingUser){\n        if (err) { return next(err); }\n        if (existingUser) {\n            return res.json({ error: true, errors : 'Bu hesap daha önce tanımlanmış ( ͡° ͜ʖ ͡°)' });\n        }\n        user.save((err) => {\n            if (err) { return next(err); }\n            req.logIn(user, (err) => {\n                if (err) {\n                    return next(err);\n                }\n                req.session.user = user;\n                res.json(user);\n            });\n        });\n    });\n};\n\ncontroller.login = (req, res, next) => {\n    req.assert('username', 'Kullanıcı adı veya Email adresi geçersiz').notEmpty();\n    req.assert('password', 'Şifre boş bırakılamaz').notEmpty();\n\n    const errors = req.validationErrors();\n\n    if (errors) {\n        return res.status(401).json({'error' : true,'errors': errors});\n    }\n    passport.authenticate('local', (err, user, info) => {\n        if (err) { return next(err); }\n        if (!user) {\n            return res.status(401).json({'error' : true,'errors': info});\n        }\n        req.logIn(user, (err) => {\n            if (err) { return next(err); }\n            if (req.body.rememberme){\n                req.session.cookie.maxAge = 2629746000;\n            }\n            req.session.user = user;\n            return res.json(user);\n        });\n    })(req, res, next);\n};\n\ncontroller.logout = (req, res) => {\n    req.logout();\n    req.session.destroy(function (err) {\n        if (err) {\n            return next(err);\n        }\n\n        // destroy session data\n        req.session = null;\n\n        // redirect to homepage\n        res.json({});\n    });\n};\n\nexport default controller;\n\n\n\n// WEBPACK FOOTER //\n// ./server/controller/user_controller.js","module.exports = require(\"connect-mongo\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"connect-mongo\"\n// module id = 40\n// module chunks = 0","import passport from 'passport';\nimport axios from 'axios';\nimport User from '../models/user';\n\nconst LocalStrategy = require('passport-local').Strategy;\nconst FacebookStrategy = require('passport-facebook').Strategy;\nconst TwitterStrategy = require('passport-twitter').Strategy;\nconst GoogleStrategy = require('passport-google-oauth').OAuth2Strategy;\n\npassport.serializeUser((user, done) => {\n    done(null, user.id);\n});\n\npassport.deserializeUser((id, done) => {\n    User.findById(id, (err, user) => {\n        done(err, user);\n    });\n});\n\n/**\n * Sign in using Email and Password.\n */\npassport.use(new LocalStrategy({ usernameField: 'username' }, (username, password, done) => {\n    const criteria = {$or: [{username: username}, {email: username}]};\n    User.findOne(criteria, (err, user) => {\n        if (err) { return done(err); }\n        if (!user) {\n            return done(null, false, { msg: `Bilgiler geçersiz :(` });\n        }\n        user.comparePassword(password, (err, isMatch) => {\n            if (err) { return done(err); }\n            if (isMatch) {\n                return done(null, user);\n            }\n            return done(null, false, { msg: 'Invalid email or password.' });\n        });\n    });\n}));\n\n/*\npassport.use(new LocalStrategy({ usernameField: 'email' }, (email, password, done) => {\n    User.findOne({ email: email.toLowerCase() }, (err, user) => {\n        if (err) { return done(err); }\n        if (!user) {\n            return done(null, false, { msg: `Email ${email} not found.` });\n        }\n        user.comparePassword(password, (err, isMatch) => {\n            if (err) { return done(err); }\n            if (isMatch) {\n                return done(null, user);\n            }\n            return done(null, false, { msg: 'Invalid email or password.' });\n        });\n    });\n}));\n*/\n/**\n * OAuth Strategy Overview\n *\n * - User is already logged in.\n *   - Check if there is an existing account with a provider id.\n *     - If there is, return an error message. (Account merging not supported)\n *     - Else link new OAuth account with currently logged-in user.\n * - User is not logged in.\n *   - Check if it's a returning user.\n *     - If returning user, sign in and we are done.\n *     - Else check if there is an existing account with user's email.\n *       - If there is, return an error message.\n *       - Else create a new account.\n */\n\n/**\n * Sign in with Facebook.\n */\npassport.use(new FacebookStrategy({\n    clientID: process.env.FACEBOOK_ID,\n    clientSecret: process.env.FACEBOOK_SECRET,\n    callbackURL: '/auth/facebook/callback',\n    profileFields: ['name', 'email', 'link', 'timezone', 'gender'],\n    passReqToCallback: true\n}, (req, accessToken, refreshToken, profile, done) => {\n    if (req.user) {\n        User.findOne({facebook: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                req.flash('errors', {msg: 'There is already a Facebook account that belongs to you. Sign in with that account or delete it, then link it with your current account.'});\n                done(err);\n            } else {\n                User.findById(req.user.id, (err, user) => {\n                    if (err) {\n                        return done(err);\n                    }\n                    user.facebook = profile.id;\n                    user.tokens.push({kind: 'facebook', accessToken});\n                    user.meta.name = user.meta.name || `${profile.name.givenName} ${profile.name.familyName}`;\n                    user.meta.gender = user.meta.gender || profile._json.gender;\n                    user.meta.picture = user.meta.picture || `https://graph.facebook.com/${profile.id}/picture?type=large`;\n                    user.save((err) => {\n                        req.flash('info', {msg: 'Facebook account has been linked.'});\n                        done(err, user);\n                    });\n                });\n            }\n        });\n    } else {\n        User.findOne({facebook: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                return done(null, existingUser);\n            }\n            User.findOne({email: profile._json.email}, (err, existingEmailUser) => {\n                if (err) {\n                    return done(err);\n                }\n                if (existingEmailUser) {\n                    req.flash('errors', {msg: 'There is already an account using this email address. Sign in to that account and link it with Facebook manually from Account Settings.'});\n                    done(err);\n                } else {\n                    const user = new User();\n                    user.email = profile._json.email;\n                    user.facebook = profile.id;\n                    user.tokens.push({kind: 'facebook', accessToken});\n                    user.meta.name = `${profile.name.givenName} ${profile.name.familyName}`;\n                    user.meta.gender = profile._json.gender;\n                    user.meta.picture = `https://graph.facebook.com/${profile.id}/picture?type=large`;\n                    user.save((err) => {\n                        done(err, user);\n                    });\n                }\n            });\n        });\n    }\n}));\n\n// Sign in with Twitter.\n\npassport.use(new TwitterStrategy({\n    consumerKey: process.env.TWITTER_KEY,\n    consumerSecret: process.env.TWITTER_SECRET,\n    callbackURL: '/auth/twitter/callback',\n    passReqToCallback: true\n}, (req, accessToken, tokenSecret, profile, done) => {\n    if (req.user) {\n        User.findOne({twitter: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                req.flash('errors', {msg: 'There is already a Twitter account that belongs to you. Sign in with that account or delete it, then link it with your current account.'});\n                done(err);\n            } else {\n                User.findById(req.user.id, (err, user) => {\n                    if (err) {\n                        return done(err);\n                    }\n                    user.twitter = profile.id;\n                    user.tokens.push({kind: 'twitter', accessToken, tokenSecret});\n                    user.meta.name = user.profile.name || profile.displayName;\n                    user.meta.picture = user.profile.picture || profile._json.profile_image_url_https;\n                    user.save((err) => {\n                        if (err) {\n                            return done(err);\n                        }\n                        req.flash('info', {msg: 'Twitter account has been linked.'});\n                        done(err, user);\n                    });\n                });\n            }\n        });\n    } else {\n        User.findOne({twitter: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                return done(null, existingUser);\n            }\n            const user = new User();\n            // Twitter will not provide an email address.  Period.\n            // But a person’s twitter username is guaranteed to be unique\n            // so we can \"fake\" a twitter email address as follows:\n            user.email = `${profile.username}@twitter.com`;\n            user.twitter = profile.id;\n            user.tokens.push({kind: 'twitter', accessToken, tokenSecret});\n            user.meta.name = profile.displayName;\n            user.meta.picture = profile._json.profile_image_url_https;\n            user.save((err) => {\n                done(err, user);\n            });\n        });\n    }\n}));\n\n/**\n * Sign in with Google.\n */\npassport.use(new GoogleStrategy({\n    clientID: process.env.GOOGLE_ID,\n    clientSecret: process.env.GOOGLE_SECRET,\n    callbackURL: '/auth/google/callback',\n    passReqToCallback: true\n}, (req, accessToken, refreshToken, profile, done) => {\n    if (req.user) {\n        User.findOne({google: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                req.flash('errors', {msg: 'There is already a Google account that belongs to you. Sign in with that account or delete it, then link it with your current account.'});\n                done(err);\n            } else {\n                User.findById(req.user.id, (err, user) => {\n                    if (err) {\n                        return done(err);\n                    }\n                    user.google = profile.id;\n                    user.tokens.push({kind: 'google', accessToken});\n                    user.meta.name = user.profile.name || profile.displayName;\n                    user.meta.gender = user.profile.gender || profile._json.gender;\n                    user.meta.picture = user.profile.picture || profile._json.image.url;\n                    user.save((err) => {\n                        req.flash('info', {msg: 'Google account has been linked.'});\n                        done(err, user);\n                    });\n                });\n            }\n        });\n    } else {\n        User.findOne({google: profile.id}, (err, existingUser) => {\n            if (err) {\n                return done(err);\n            }\n            if (existingUser) {\n                return done(null, existingUser);\n            }\n            User.findOne({email: profile.emails[0].value}, (err, existingEmailUser) => {\n                if (err) {\n                    return done(err);\n                }\n                if (existingEmailUser) {\n                    req.flash('errors', {msg: 'There is already an account using this email address. Sign in to that account and link it with Google manually from Account Settings.'});\n                    done(err);\n                } else {\n                    const user = new User();\n                    user.email = profile.emails[0].value;\n                    user.google = profile.id;\n                    user.tokens.push({kind: 'google', accessToken});\n                    user.meta.name = profile.displayName;\n                    user.meta.gender = profile._json.gender;\n                    user.meta.picture = profile._json.image.url;\n                    user.save((err) => {\n                        done(err, user);\n                    });\n                }\n            });\n        });\n    }\n}));\n\n/**\n * Login Required middleware.\n */\nexports.isAuthenticated = (req, res, next) => {\n    if (req.isAuthenticated()) {\n        return next();\n    }\n    res.redirect('/login');\n};\n\n/**\n * Authorization Required middleware.\n */\nexports.isAuthorized = (req, res, next) => {\n    const provider = req.path.split('/').slice(-1)[0];\n    const token = req.user.tokens.find(token => token.kind === provider);\n    if (token) {\n        next();\n    } else {\n        res.redirect(`/auth/${provider}`);\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./server/library/passport.js","module.exports = require(\"passport-local\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-local\"\n// module id = 42\n// module chunks = 0","module.exports = require(\"passport-facebook\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-facebook\"\n// module id = 43\n// module chunks = 0","module.exports = require(\"passport-twitter\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-twitter\"\n// module id = 44\n// module chunks = 0","module.exports = require(\"passport-google-oauth\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"passport-google-oauth\"\n// module id = 45\n// module chunks = 0","const path = require('path');\nmodule.exports = {\n    head: {\n        title: 'AnizmTV DEV',\n        meta: [\n            {charset: 'utf-8'},\n            {name: 'viewport', content: 'width=device-width, initial-scale=1'},\n            {hid: 'description', name: 'description', content: 'Nuxt.js project'},\n            {name: 'theme-color', content: \"#191919\"}\n        ],\n        link: [],\n        script: [\n            {src : 'https://use.fontawesome.com/1a9887d093.js'}\n        ]\n    },\n    srcDir: 'view/',\n    css: [\n        '@/assets/css/framework.scss'\n    ],\n    plugins: [\n        '@/plugins/svg',\n        '@/plugins/validate',\n        {src: '~/plugins/anime', ssr: false}\n    ],\n    modules: [\n        '@nuxtjs/axios'\n    ],\n    axios: {\n        credentials: true,\n    },\n    router: {\n        //middleware: ['ssr-cookie'],\n        extendRoutes(routes, resolve) {\n            routes.push({\n                name: 'anime-episodes',\n                path: '/anime/:anime/bolum-:episode-izle',\n                component: resolve(__dirname, 'view/pages/anime/episode/index.vue')\n            })\n        }\n    },\n    build: {\n        filenames: {\n            css: 'anizmcore.[contenthash].css',\n            manifest: 'manifest.[hash].js',\n            vendor: 'anizmcore.[chunkhash].js',\n            app: 'anizmapp.[chunkhash].js',\n            chunk: '[name].[chunkhash].js'\n        },\n        extractCSS: true,\n        vendor: ['axios', 'moment'],\n        postcss: {\n            plugins: {\n                'postcss-cssnext': {\n                    zindex: false\n                }\n            }\n        },\n        extend(config, {dev, isClient}) {\n            /**\n             * Initialise SVG Sprites\n             */\n\n                // get and remove file loader\n            const rule = config.module.rules.find(r => r.test.toString() === '/\\\\.(png|jpe?g|gif|svg)$/');\n            config.module.rules.splice(config.module.rules.indexOf(rule), 1);\n\n            // add it again, but now without 'assets\\/svg'\n            config.module.rules.push({\n                test: /\\.(png|jpe?g|gif|svg)$/,\n                loader: 'url-loader',\n                exclude: path.resolve(__dirname, 'view/assets/svg'),\n                query: {\n                    limit: 1000, // 1KO\n                    name: 'img/[name].[hash:7].[ext]',\n                },\n            });\n\n            config.module.rules.push({\n                test: /\\.svg$/,\n                include: [\n                    path.resolve(__dirname, 'view/assets/svg'),\n                ],\n                loader: 'svg-sprite-loader?' + JSON.stringify({\n                    name: '[name]',\n                    prefixize: false\n                })\n            });\n            config.output.jsonpFunction = 'anizmJsonp';\n        },\n    },\n    render: {\n        bundleRenderer: {\n            shouldPreload: (file, type) => {\n                return ['script', 'style', 'font'].includes(type)\n            }\n        },\n        http2 :{\n            push : true\n        },\n        gzip : {\n            treshold : 1\n        }\n    }\n};\n\n\n// WEBPACK FOOTER //\n// ./nuxt.config.js","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 47\n// module chunks = 0"],"sourceRoot":""}